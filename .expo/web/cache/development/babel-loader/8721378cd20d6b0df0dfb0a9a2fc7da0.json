{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/home/alex/workspace/papamama/src/components/modals/RateOrderModal.js\";\nimport React, { useContext, useEffect, useState } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport Animated from \"react-native-web/dist/exports/Animated\";\nimport Easing from \"react-native-web/dist/exports/Easing\";\nimport { Context as AppSettingsContext } from \"../../context/AppSettingsContext\";\nimport { createIconSetFromIcoMoon } from \"@expo/vector-icons\";\nimport icoMoonConfig from \"../../../selection.json\";\nvar IcoMoonIcon = createIconSetFromIcoMoon(icoMoonConfig, 'icomoon', 'icomoon.ttf');\nimport axiosWithToken from \"../../services/axiosWithToken\";\nimport { prepareLanguageToHttpRequest } from \"../../helpers/helpers\";\nimport { BASE_URL, APP_VERSION } from \"../../different/global_vars\";\nimport StarRating from 'react-native-star-rating';\nimport translator from \"../../translator/translator\";\nimport { Spacer } from \"../shared\";\nimport styles from \"../../styles/components/modals/rate-order-modal\";\nimport { app_styles } from \"../../styles/app_styles\";\n\nvar RateOrderModal = function RateOrderModal(_ref) {\n  var isOpened = _ref.isOpened,\n      closeCallback = _ref.closeCallback,\n      order = _ref.order,\n      updateOrderRating = _ref.updateOrderRating;\n\n  var _useContext = useContext(AppSettingsContext),\n      _useContext$state = _useContext.state,\n      scales = _useContext$state.scales,\n      language = _useContext$state.language;\n\n  var _useState = useState(parseInt(order.rating)),\n      _useState2 = _slicedToArray(_useState, 2),\n      rating = _useState2[0],\n      setRating = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      disabled = _useState4[0],\n      setDisabled = _useState4[1];\n\n  var _useState5 = useState(new Animated.Value(0)),\n      _useState6 = _slicedToArray(_useState5, 2),\n      animatedHeight = _useState6[0],\n      setAnimatedHeight = _useState6[1];\n\n  var _useState7 = useState(new Animated.Value(0)),\n      _useState8 = _slicedToArray(_useState7, 2),\n      animatedOpacity = _useState8[0],\n      setAnimatedOpacity = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      isDataLoading = _useState10[0],\n      setIsDataLoading = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      loadingError = _useState12[0],\n      setLoadingError = _useState12[1];\n\n  useEffect(function () {\n    if (order.rating) {\n      startAnimation();\n    }\n  }, [rating]);\n\n  var rateOrder = function rateOrder(value) {\n    var lang, url, form, response, status;\n    return _regeneratorRuntime.async(function rateOrder$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!(value === parseInt(order.rating))) {\n              _context.next = 2;\n              break;\n            }\n\n            return _context.abrupt(\"return\");\n\n          case 2:\n            _context.prev = 2;\n            setIsDataLoading(true);\n            lang = prepareLanguageToHttpRequest(language);\n            url = BASE_URL + \"/order/set-rating?lang=\" + lang + \"&version=\" + APP_VERSION;\n            form = new FormData();\n            form.append('order_id', order.order_id);\n            form.append('rating', value);\n            _context.next = 11;\n            return _regeneratorRuntime.awrap(axiosWithToken.post(url, form));\n\n          case 11:\n            response = _context.sent;\n\n            if (!(response && response.data && response.data.status)) {\n              _context.next = 23;\n              break;\n            }\n\n            status = response.data.status;\n\n            if (!(status === 'success')) {\n              _context.next = 20;\n              break;\n            }\n\n            if (!rating || animatedHeight._value === 0) {\n              startAnimation();\n            }\n\n            setRating(value);\n            return _context.abrupt(\"return\", updateOrderRating(order.order_id, value));\n\n          case 20:\n            setLoadingError(true);\n\n          case 21:\n            _context.next = 24;\n            break;\n\n          case 23:\n            setLoadingError(true);\n\n          case 24:\n            _context.next = 29;\n            break;\n\n          case 26:\n            _context.prev = 26;\n            _context.t0 = _context[\"catch\"](2);\n            setLoadingError(true);\n\n          case 29:\n            _context.prev = 29;\n            setIsDataLoading(false);\n            return _context.finish(29);\n\n          case 32:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[2, 26, 29, 32]], Promise);\n  };\n\n  var getAppropriateIconName = function getAppropriateIconName() {\n    return String(rating);\n  };\n\n  var startAnimation = function startAnimation() {\n    Animated.parallel([Animated.timing(animatedOpacity, {\n      toValue: 1,\n      duration: 300,\n      delay: 600,\n      easing: Easing.linear\n    }), Animated.timing(animatedHeight, {\n      toValue: Math.round(scales.heightScale * 85),\n      duration: 600,\n      easing: Easing.linear\n    })]).start();\n  };\n\n  return React.createElement(Modal, {\n    animationType: \"fade\",\n    transparent: true,\n    visible: isOpened,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 9\n    }\n  }, React.createElement(View, {\n    style: styles(scales).modal_content_container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 13\n    }\n  }, React.createElement(View, {\n    style: styles(scales).modal_card,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 17\n    }\n  }, React.createElement(View, {\n    style: styles(scales).card_body,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 21\n    }\n  }, loadingError ? React.createElement(View, {\n    style: styles(scales).error_container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 37\n    }\n  }, React.createElement(Text, {\n    style: styles(scales).card_title,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 41\n    }\n  }, \"Oooppsss...\"), React.createElement(Spacer, {\n    spaceHeight: 25,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 41\n    }\n  }), React.createElement(Text, {\n    style: styles(scales).info,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 41\n    }\n  }, translator.translate(language, \"Щось пішло не так і виникла помилка. Будь-ласка спробуйте ще раз.\")), React.createElement(Spacer, {\n    spaceHeight: 25,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 41\n    }\n  }), React.createElement(TouchableOpacity, {\n    onPress: function onPress() {\n      return setLoadingError(false);\n    },\n    activeOpacity: .8,\n    style: styles(scales).clear_err_btn,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 41\n    }\n  }, React.createElement(Text, {\n    style: styles(scales).btn_title,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 45\n    }\n  }, \"Ok\"))) : React.createElement(React.Fragment, null, React.createElement(Text, {\n    style: styles(scales).card_title,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 41\n    }\n  }, translator.translate(language, \"Ваша оцінка\")), React.createElement(Spacer, {\n    spaceHeight: 25,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 41\n    }\n  }), React.createElement(StarRating, {\n    activeOpacity: .8,\n    disabled: disabled,\n    buttonStyle: {\n      margin: Math.round(scales.widthScale * 4),\n      padding: 0\n    },\n    containerStyle: {\n      alignSelf: 'center'\n    },\n    starSize: Math.round(scales.widthScale * 40),\n    maxStars: 5,\n    rating: rating,\n    emptyStarColor: \"#8c8c8e\",\n    selectedStar: function selectedStar(rating) {\n      return rateOrder(rating);\n    },\n    fullStarColor: \"#FFC837\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 41\n    }\n  }), rating ? React.createElement(Animated.View, {\n    style: {\n      height: animatedHeight,\n      opacity: animatedOpacity,\n      flexDirection: 'row',\n      alignSelf: 'stretch',\n      justifyContent: 'center',\n      alignItems: 'center'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 53\n    }\n  }, React.createElement(IcoMoonIcon, {\n    name: getAppropriateIconName(),\n    color: \"#8c8c8e\",\n    size: Math.round(scales.widthScale * 60),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 57\n    }\n  })) : React.createElement(Spacer, {\n    spaceHeight: 25,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 51\n    }\n  }), React.createElement(Text, {\n    style: styles(scales).info,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 41\n    }\n  }, translator.translate(language, \"Оцініть, будь ласка, якість замовлення (швидкість доставки, якість продукції тощо) за шкалою від 1 до 5\"), \".\"))), React.createElement(TouchableOpacity, {\n    onPress: function onPress() {\n      return closeCallback();\n    },\n    style: styles(scales).close_modal_button,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 21\n    }\n  }, React.createElement(IcoMoonIcon, {\n    name: \"cancel\",\n    color: app_styles(scales).colors.text.primary,\n    size: Math.round(scales.widthScale * 14),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 25\n    }\n  })), isDataLoading ? React.createElement(View, {\n    style: styles(scales).preloader_container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 33\n    }\n  }, React.createElement(ActivityIndicator, {\n    size: \"large\",\n    color: app_styles(scales).colors.app.blue,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 37\n    }\n  })) : null)));\n};\n\nexport default RateOrderModal;","map":{"version":3,"sources":["/home/alex/workspace/papamama/src/components/modals/RateOrderModal.js"],"names":["React","useContext","useEffect","useState","Context","AppSettingsContext","createIconSetFromIcoMoon","icoMoonConfig","IcoMoonIcon","axiosWithToken","prepareLanguageToHttpRequest","BASE_URL","APP_VERSION","StarRating","translator","Spacer","styles","app_styles","RateOrderModal","isOpened","closeCallback","order","updateOrderRating","state","scales","language","parseInt","rating","setRating","disabled","setDisabled","Animated","Value","animatedHeight","setAnimatedHeight","animatedOpacity","setAnimatedOpacity","isDataLoading","setIsDataLoading","loadingError","setLoadingError","startAnimation","rateOrder","value","lang","url","form","FormData","append","order_id","post","response","data","status","_value","getAppropriateIconName","String","parallel","timing","toValue","duration","delay","easing","Easing","linear","Math","round","heightScale","start","modal_content_container","modal_card","card_body","error_container","card_title","info","translate","clear_err_btn","btn_title","margin","widthScale","padding","alignSelf","height","opacity","flexDirection","justifyContent","alignItems","close_modal_button","colors","text","primary","preloader_container","app","blue"],"mappings":"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","sourcesContent":["//----IMPORTS----//\n//React\nimport React, { useContext, useEffect, useState } from 'react';\n//React native\nimport { View, Text, Modal, TouchableOpacity, ActivityIndicator, Animated, Easing } from 'react-native';\n//Context\nimport { Context as AppSettingsContext } from \"../../context/AppSettingsContext\";\n//React-native-vector-icons package\nimport { createIconSetFromIcoMoon } from 'react-native-vector-icons';\nimport icoMoonConfig from '../../../selection.json';\nconst IcoMoonIcon = createIconSetFromIcoMoon(icoMoonConfig, 'icomoon', 'icomoon.ttf');\n//Services\nimport axiosWithToken from \"../../services/axiosWithToken\";\n//Helpers\nimport { prepareLanguageToHttpRequest } from \"../../helpers/helpers\";\n//Global vars\nimport { BASE_URL, APP_VERSION } from \"../../different/global_vars\";\n//Rating\nimport StarRating from 'react-native-star-rating';\n//Translator\nimport translator from \"../../translator/translator\";\n//Components\nimport { Spacer } from \"../shared\";\n//Styles\nimport styles from \"../../styles/components/modals/rate-order-modal\";\nimport { app_styles } from \"../../styles/app_styles\";\n\n\n\n\n//----COMPONENT----//\nconst RateOrderModal = ({ isOpened, closeCallback, order, updateOrderRating }) => {\n    //Data and State\n    const { state: { scales, language } } = useContext(AppSettingsContext);\n    const [rating, setRating] = useState(parseInt(order.rating));\n    const [disabled, setDisabled] = useState(false);\n    const [animatedHeight, setAnimatedHeight] = useState(new Animated.Value(0));\n    const [animatedOpacity, setAnimatedOpacity] = useState(new Animated.Value(0));\n    const [isDataLoading, setIsDataLoading] = useState(false);\n    const [loadingError, setLoadingError] = useState(false);\n\n\n\n    //Hooks and methods\n    useEffect(() => {\n        if(order.rating){\n            startAnimation();\n        }\n    }, [rating]);\n\n\n    const rateOrder = async (value) => {\n        if(value === parseInt(order.rating)) return;\n        try {\n            setIsDataLoading(true)\n\n            const lang = prepareLanguageToHttpRequest(language);\n            const url = `${BASE_URL}/order/set-rating?lang=${lang}&version=${APP_VERSION}`;\n\n            let form = new FormData();\n            form.append('order_id', order.order_id);\n            form.append('rating', value);\n\n            const response = await axiosWithToken.post(url, form);\n\n            if (response && response.data && response.data.status) {\n                let status = response.data.status;\n                if (status === 'success') {\n                    \n                    if (!rating || animatedHeight._value === 0) {\n                        startAnimation();\n                    }\n                    setRating(value);\n                    return updateOrderRating(order.order_id, value)\n                } else {\n                    setLoadingError(true)\n                }\n            } else {\n                setLoadingError(true)\n            }\n        } catch (error) {\n            setLoadingError(true)\n        } finally {\n            setIsDataLoading(false);\n        }\n    }\n\n\n\n    const getAppropriateIconName = () => {\n        return String(rating);\n    }\n\n\n\n    const startAnimation = () => {\n        Animated.parallel([\n            Animated.timing(animatedOpacity, {\n                toValue: 1,\n                duration: 300,\n                delay: 600,\n                easing: Easing.linear\n            }),\n            Animated.timing(animatedHeight, {\n                toValue: Math.round(scales.heightScale * 85),\n                duration: 600,\n                easing: Easing.linear\n            })\n        ]).start();\n    }\n\n\n    //Template\n    return (\n        <Modal\n            animationType=\"fade\"\n            transparent={true}\n            visible={isOpened}\n        >\n            <View style={styles(scales).modal_content_container}>\n                <View style={styles(scales).modal_card}>\n                    {/* Card body */}\n                    <View style={styles(scales).card_body}>\n                        {\n                            loadingError\n                                ? (\n                                    <View style={styles(scales).error_container}>\n                                        <Text style={styles(scales).card_title}>Oooppsss...</Text>\n                                        <Spacer spaceHeight={25} />\n                                        <Text style={styles(scales).info}>{translator.translate(language, \"Щось пішло не так і виникла помилка. Будь-ласка спробуйте ще раз.\")}</Text>\n                                        <Spacer spaceHeight={25} />\n                                        <TouchableOpacity onPress={() => setLoadingError(false)} activeOpacity={.8} style={styles(scales).clear_err_btn}>\n                                            <Text style={styles(scales).btn_title}>Ok</Text>\n                                        </TouchableOpacity>\n                                    </View>\n                                )\n                                : (\n                                    <>\n                                        <Text style={styles(scales).card_title}>{translator.translate(language, \"Ваша оцінка\")}</Text>\n                                        <Spacer spaceHeight={25} />\n                                        <StarRating\n                                            activeOpacity={.8}\n                                            disabled={disabled}\n                                            buttonStyle={{ margin: Math.round(scales.widthScale * 4), padding: 0 }}\n                                            containerStyle={{ alignSelf: 'center' }}\n                                            starSize={Math.round(scales.widthScale * 40)}\n                                            maxStars={5}\n                                            rating={rating}\n                                            emptyStarColor=\"#8c8c8e\"\n                                            selectedStar={(rating) => rateOrder(rating)}\n                                            fullStarColor=\"#FFC837\"\n\n                                        />\n                                        {\n                                            rating\n                                                ? (\n                                                    <Animated.View style={{\n                                                        height: animatedHeight,\n                                                        opacity: animatedOpacity,\n                                                        flexDirection: 'row',\n                                                        alignSelf: 'stretch',\n                                                        justifyContent: 'center',\n                                                        alignItems: 'center',\n                                                    }}>\n                                                        <IcoMoonIcon name={getAppropriateIconName()} color=\"#8c8c8e\" size={Math.round(scales.widthScale * 60)} />\n                                                    </Animated.View>\n                                                )\n                                                : <Spacer spaceHeight={25} />\n                                        }\n                                        <Text style={styles(scales).info}>{translator.translate(language, \"Оцініть, будь ласка, якість замовлення (швидкість доставки, якість продукції тощо) за шкалою від 1 до 5\")}.</Text>\n                                    </>\n                                )\n                        }\n                    </View>\n                    {/* Close button */}\n                    <TouchableOpacity onPress={() => closeCallback()} style={styles(scales).close_modal_button}>\n                        <IcoMoonIcon name=\"cancel\" color={app_styles(scales).colors.text.primary} size={Math.round(scales.widthScale * 14)} />\n                    </TouchableOpacity>\n                    {/* Preloader */}\n                    {\n                        isDataLoading\n                            ? (\n                                <View style={styles(scales).preloader_container}>\n                                    <ActivityIndicator size=\"large\" color={app_styles(scales).colors.app.blue} />\n                                </View>\n                            )\n                            : null\n                    }\n                </View>\n            </View>\n        </Modal>\n    )\n}\n\n\n\n\n//----EXPORT----//\nexport default RateOrderModal;"]},"metadata":{},"sourceType":"module"}