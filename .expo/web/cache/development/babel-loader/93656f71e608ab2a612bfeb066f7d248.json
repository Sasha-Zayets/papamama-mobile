{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/home/alex/workspace/papamama/src/screens/MakeOrderScreen.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState, useContext } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { WebView } from 'react-native-webview';\nimport { Context as AppSettingsContext } from \"../context/AppSettingsContext\";\nimport { Context as AuthContext } from \"../context/AuthContext\";\nimport { Context as MenuContext } from \"../context/MenuContext\";\nimport { createIconSetFromIcoMoon } from \"@expo/vector-icons\";\nimport icoMoonConfig from \"../../selection.json\";\nvar IcoMoonIcon = createIconSetFromIcoMoon(icoMoonConfig, 'icomoon', 'icomoon.ttf');\nimport moment from \"moment\";\nimport 'moment/locale/uk';\nimport Header from \"../components/shared/Header\";\nimport { SafeView, Block, Spacer, DataLoadingIndicator, VerticalSpacer, HorizontalDivider } from \"../components/shared\";\nimport { NetworkErrorModal, SuccessOrderModal, OnlinePaymentInfoModal, ClearCartModal } from \"../components/modals\";\nimport { ButtonPrimary, ButtonRadio, ButtonToggler } from \"../components/buttons\";\nimport { PhoneInput, SelectInput, SimpleInput, DateTimePikerInput } from \"../components/inputs\";\nimport { formatPrice, reformatUserPhone } from \"../helpers/helpers\";\nimport translator from \"../translator/translator\";\nimport styles from \"../styles/screens/make-order-screen\";\nimport { app_styles } from \"../styles/app_styles\";\n\nvar MakeOrderScreen = function MakeOrderScreen(_ref) {\n  var navigation = _ref.navigation;\n\n  var _useContext = useContext(AppSettingsContext),\n      _useContext$state = _useContext.state,\n      scales = _useContext$state.scales,\n      language = _useContext$state.language,\n      deliveryCities = _useContext$state.deliveryCities,\n      deliveryCitiesNetworkError = _useContext$state.deliveryCitiesNetworkError,\n      isDataFetching = _useContext$state.isDataFetching,\n      appSettings = _useContext$state.appSettings,\n      homeCityId = _useContext$state.homeCityId,\n      getDeliveryCities = _useContext.getDeliveryCities,\n      clearDeliveryCitiesNetworkError = _useContext.clearDeliveryCitiesNetworkError;\n\n  var _useContext2 = useContext(AuthContext),\n      _useContext2$state = _useContext2.state,\n      user = _useContext2$state.user,\n      isLoggedIn = _useContext2$state.isLoggedIn,\n      last_order_address = _useContext2$state.last_order_address,\n      setFromMakeOrder = _useContext2.setFromMakeOrder,\n      writeOffBonuses = _useContext2.writeOffBonuses,\n      updateLastOrderAddress = _useContext2.updateLastOrderAddress,\n      updateUserData = _useContext2.updateUserData;\n\n  var _useContext3 = useContext(MenuContext),\n      _useContext3$state = _useContext3.state,\n      cart = _useContext3$state.cart,\n      validationErrors = _useContext3$state.validationErrors,\n      networkError = _useContext3$state.networkError,\n      paymentWidgetHtml = _useContext3$state.paymentWidgetHtml,\n      clearValidationErrors = _useContext3.clearValidationErrors,\n      clearNetworkError = _useContext3.clearNetworkError,\n      clearAllValidationsErrors = _useContext3.clearAllValidationsErrors,\n      setValidationErrors = _useContext3.setValidationErrors,\n      makeOrder = _useContext3.makeOrder,\n      clearCart = _useContext3.clearCart;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isDataLoading = _useState2[0],\n      setIsDataLoading = _useState2[1];\n\n  var _useState3 = useState({\n    name: user.name || user.username ? user.name || user.username : null,\n    phone: user.phone ? reformatUserPhone(user.phone) : null,\n    city: last_order_address.city && last_order_address.city !== 'null' ? last_order_address.city : null,\n    other_city_name: null,\n    street: last_order_address.street && last_order_address.street !== 'null' ? last_order_address.street : null,\n    enterence: (last_order_address.entrance && last_order_address.entrance) !== 'null' ? last_order_address.entrance : null,\n    house: (last_order_address.house_number && last_order_address.house_number) !== 'null' ? last_order_address.house_number : null,\n    flat: last_order_address.apartment_number && last_order_address.apartment_number !== 'null' ? last_order_address.apartment_number : null,\n    time: null,\n    comment: null,\n    payment_type: 'cash',\n    do_not_call: last_order_address.do_not_call && last_order_address.do_not_call !== 'null' ? parseInt(last_order_address.do_not_call) : 0,\n    have_a_child: last_order_address.have_a_child && last_order_address.have_a_child !== 'null' ? parseInt(last_order_address.have_a_child) : 0,\n    have_a_dog: last_order_address.have_a_dog && last_order_address.have_a_dog !== 'null' ? parseInt(last_order_address.have_a_dog) : 0\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      orderData = _useState4[0],\n      setOrderData = _useState4[1];\n\n  var _useState5 = useState({\n    packing_price: 0,\n    delivery_price: 0,\n    products_price: 0,\n    total_price: 0,\n    sauce_price: 0,\n    extra_ingredients: 0\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      prices = _useState6[0],\n      setPrices = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      showSuccessOrderModal = _useState8[0],\n      setShowSuccessOrderModal = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      showPaymentModal = _useState10[0],\n      setShowPaymentModal = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      showOnlinePaymentInfoModal = _useState12[0],\n      setShowOnlinePaymentInfoModal = _useState12[1];\n\n  var _useState13 = useState(false),\n      _useState14 = _slicedToArray(_useState13, 2),\n      showClearCartModal = _useState14[0],\n      setShowClearCartModal = _useState14[1];\n\n  var _useState15 = useState(false),\n      _useState16 = _slicedToArray(_useState15, 2),\n      isOrderPaid = _useState16[0],\n      setIsOrderPaid = _useState16[1];\n\n  var _useState17 = useState(false),\n      _useState18 = _slicedToArray(_useState17, 2),\n      lowOrederSum = _useState18[0],\n      setLowOrderSum = _useState18[1];\n\n  var _useState19 = useState(false),\n      _useState20 = _slicedToArray(_useState19, 2),\n      isWayForPaySystemUsed = _useState20[0],\n      setIsWayForPaySystemUsed = _useState20[1];\n\n  useEffect(function () {\n    if (!deliveryCities.length) {\n      fetchDelivrySities();\n    }\n\n    calculatePrices();\n    return function () {\n      clearAllValidationsErrors();\n    };\n  }, [orderData, paymentWidgetHtml]);\n\n  var handlePhoneInput = function handlePhoneInput(value) {\n    autocompletePhone(value);\n  };\n\n  var clearOrderData = function clearOrderData() {\n    setOrderData(_objectSpread(_objectSpread({}, orderData), {}, {\n      city: null,\n      street: null,\n      enterence: null,\n      house: null,\n      flat: null,\n      time: null,\n      comment: null\n    }));\n  };\n\n  var fetchDelivrySities = function fetchDelivrySities() {\n    return _regeneratorRuntime.async(function fetchDelivrySities$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(getDeliveryCities());\n\n          case 2:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var autocompletePhone = function autocompletePhone(value) {\n    if (value !== null && value.length <= 5) {\n      setCustomerPhone(\"+380 \");\n    } else {\n      if (value === null) {\n        setCustomerPhone(null);\n        return;\n      }\n\n      if (value.length <= 17) {\n        refactorCurrentPhoneValue(value, [7, 11, 14], \" \");\n      } else if (value.length > 17) {\n        refactorCurrentPhoneValue(value, [7, 11, 14], \" \");\n        var phoneNumber = orderData.phone.substring(0, 17);\n        setCustomerPhone(phoneNumber);\n      }\n    }\n  };\n\n  var refactorCurrentPhoneValue = function refactorCurrentPhoneValue(value, charPositions, symbol) {\n    var splitedVal = value.split(\"\");\n\n    for (var i = 0; i < charPositions.length; i++) {\n      if (splitedVal[charPositions[i]] && splitedVal[charPositions[i]] !== symbol) {\n        var phoneNumber = orderData.phone.substring(0, charPositions[i]) + symbol + orderData.phone.substring(charPositions[i]) + value.substr(-1, 1);\n        setCustomerPhone(phoneNumber);\n        return;\n      } else {\n        setCustomerPhone(value);\n      }\n    }\n  };\n\n  var setCustomerPhone = function setCustomerPhone(value) {\n    setOrderData(_objectSpread(_objectSpread({}, orderData), {}, {\n      phone: value\n    }));\n  };\n\n  var handleFormInputs = function handleFormInputs(name, value) {\n    setOrderData(_objectSpread(_objectSpread({}, orderData), {}, _defineProperty({}, name, value)));\n  };\n\n  var handlePaymentMethod = function handlePaymentMethod(value) {\n    setOrderData(_objectSpread(_objectSpread({}, orderData), {}, {\n      payment_type: value\n    }));\n  };\n\n  var getSauceValue = function getSauceValue(product) {\n    if (!product.properties || !product.properties.length) return;\n    if (!product.sauce) return 0;\n    return product.size === 2 ? product.sauce.price2 : product.sauce.price;\n  };\n\n  var calculatePrices = function calculatePrices() {\n    var packingPrice = 0;\n    var productsPrice = 0;\n    var deliveryPrice = 0;\n    var extraIngredients = 0;\n    var saucePrice = 0;\n    cart.forEach(function (item) {\n      if (hasIngredients(item)) {\n        var value = 0;\n        item.main_ingredients.forEach(function (ingr) {\n          if (ingr.checked) {\n            value += parseFloat(ingr.quantity) * parseFloat(ingr.price);\n          }\n        });\n        extraIngredients += value * item.quantity;\n      }\n\n      if (item.sauce) {\n        saucePrice += getSauceValue(item) * Number(item.quantity);\n      }\n\n      productsPrice += Number(item.quantity) * getProductPrice(item);\n      packingPrice += Number(item.quantity) * getProductPackingPrice(item);\n    });\n\n    if (orderData.city) {\n      var deliveryInfo = appSettings.delivery;\n      var totalVal = productsPrice + packingPrice + extraIngredients;\n\n      if (Number(orderData.city.id) !== homeCityId) {\n        var secondary = deliveryInfo['secondary'];\n\n        if (totalVal >= Number(secondary['min_sum_for_promo_delivery'])) {\n          deliveryPrice = Number(secondary['promo_delivery_price']);\n        } else {\n          deliveryPrice = Number(secondary['price']);\n        }\n\n        if (totalVal < secondary['min_order_price']) {\n          setLowOrderSum(true);\n        } else {\n          setLowOrderSum(false);\n        }\n      } else {\n        var main = deliveryInfo['main'];\n\n        if (totalVal < Number(main['min_free_delivery_sum'])) {\n          deliveryPrice = Number(main['price']);\n        }\n\n        if (totalVal < main['min_order_price']) {\n          setLowOrderSum(true);\n        } else {\n          setLowOrderSum(false);\n        }\n      }\n    }\n\n    var total_price = packingPrice + productsPrice + extraIngredients + deliveryPrice + saucePrice;\n    setPrices({\n      packing_price: packingPrice,\n      delivery_price: deliveryPrice,\n      products_price: productsPrice,\n      extra_ingredients: extraIngredients,\n      sauce_price: saucePrice,\n      total_price: total_price\n    });\n  };\n\n  var hasIngredients = function hasIngredients(product) {\n    return !!product.category.has_ingredients;\n  };\n\n  var getProductPrice = function getProductPrice(product) {\n    var variant = product.variants.find(function (item) {\n      return item.size === product.size;\n    });\n    return variant ? parseFloat(variant['price']) : product.variants[0]['price'];\n  };\n\n  var getProductPackingPrice = function getProductPackingPrice(product) {\n    return product.category && product.category.packing_price ? parseFloat(product.category.packing_price) : 0;\n  };\n\n  var formSubmit = function formSubmit() {\n    var requiredFields, deliveryInfo, minimumOrderSum, alertMessage, cleanedPhone, form, response;\n    return _regeneratorRuntime.async(function formSubmit$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            requiredFields = orderData.city && orderData.city.id === 0 ? ['name', 'phone', 'other_city_name', 'street', 'house', 'time'] : ['name', 'phone', 'city', 'street', 'house', 'time'];\n\n            if (!hasEmptyFields(orderData, requiredFields)) {\n              _context2.next = 4;\n              break;\n            }\n\n            return _context2.abrupt(\"return\");\n\n          case 4:\n            if (validatePhoneLength()) {\n              _context2.next = 6;\n              break;\n            }\n\n            return _context2.abrupt(\"return\");\n\n          case 6:\n            if (timeIsValid()) {\n              _context2.next = 8;\n              break;\n            }\n\n            return _context2.abrupt(\"return\");\n\n          case 8:\n            if (!lowOrederSum) {\n              _context2.next = 14;\n              break;\n            }\n\n            deliveryInfo = appSettings.delivery;\n            minimumOrderSum = orderData.city.id === homeCityId ? deliveryInfo['main']['min_order_price'] : deliveryInfo['secondary']['min_order_price'];\n            alertMessage = translator.translate(language, \"Мінімальна сума замовлення для Вашого населеного пункту становить :SUM грн.\");\n            alertMessage = alertMessage.replace(/:SUM/, formatPrice(language, minimumOrderSum));\n            return _context2.abrupt(\"return\", Alert.alert(translator.translate(language, \"Увага!\"), alertMessage));\n\n          case 14:\n            setIsDataLoading(true);\n            cleanedPhone = orderData.phone.replace(/\\s/g, '');\n            form = {\n              inputs: {\n                name: orderData.name,\n                email: user.email,\n                phone: cleanedPhone,\n                city_id: orderData.city.id,\n                city_name: orderData.other_city_name || orderData.city.name,\n                street: orderData.street,\n                house_number: orderData.house,\n                payment_type: orderData.payment_type === 'cash' ? 1 : 2,\n                time: orderData.time,\n                do_not_call: orderData.do_not_call ? 1 : 0,\n                have_a_child: orderData.have_a_child ? 1 : 0,\n                have_a_dog: orderData.have_a_dog ? 1 : 0\n              },\n              cart: transformCartForOrder()\n            };\n\n            if (orderData.enterence) {\n              form.inputs.entrance = orderData.enterence;\n            }\n\n            if (orderData.flat) {\n              form.inputs.apartment_number = orderData.flat;\n            }\n\n            if (orderData.comment) {\n              form.inputs.comment = orderData.comment;\n            }\n\n            _context2.next = 22;\n            return _regeneratorRuntime.awrap(makeOrder(form));\n\n          case 22:\n            response = _context2.sent;\n\n            if (response.payment_url) {\n              isWayForPay(response.payment_url);\n              setShowOnlinePaymentInfoModal(true);\n            } else {\n              refreshLastOrderAddress();\n              setShowSuccessOrderModal(true);\n\n              if (!user.phone) {\n                updateUserData('phone', orderData.phone);\n              }\n            }\n\n            setLowOrderSum(false);\n            setIsDataLoading(false);\n            _context2.next = 31;\n            break;\n\n          case 28:\n            _context2.prev = 28;\n            _context2.t0 = _context2[\"catch\"](0);\n            setIsDataLoading(false);\n\n          case 31:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[0, 28]], Promise);\n  };\n\n  var transformCartForOrder = function transformCartForOrder() {\n    var cartForOrder = [];\n    cart.forEach(function (item) {\n      var position = {};\n\n      if (item.category.has_ingredients) {\n        position.main_ingredients = transformIngredients(item.main_ingredients);\n      }\n\n      if (item.sauce) {\n        position.property_id = item.sauce.id;\n      }\n\n      position.type = item.type;\n      position.product_id = item.id;\n      position.quantity = item.quantity;\n      position.size = item.size || 1;\n\n      if (item.comment) {\n        position.comment = item.comment;\n      }\n\n      cartForOrder.push(position);\n    });\n    return cartForOrder;\n\n    function transformIngredients(data) {\n      var result = [];\n      data.forEach(function (item) {\n        if (item.checked && item.checked === 1) {\n          var position = {\n            ingredient_id: item.id,\n            quantity: item.quantity\n          };\n          result.push(position);\n        }\n      });\n      return result;\n    }\n  };\n\n  var hasEmptyFields = function hasEmptyFields(data, requiredFields) {\n    var errors = {};\n\n    for (var key in data) {\n      if (requiredFields.includes(key) && !data[key]) {\n        errors[key] = translator.translate(language, \"Поле не може бути порожнім!\");\n      }\n    }\n\n    if (Object.keys(errors).length) {\n      setValidationErrors(errors);\n      return true;\n    }\n\n    return false;\n  };\n\n  var validatePhoneLength = function validatePhoneLength() {\n    if (!orderData.phone) return;\n\n    if (orderData.phone.length < 17) {\n      setValidationErrors({\n        phone: translator.translate(language, \"Перевірте правильність введеного номеру телефону\")\n      });\n      return false;\n    }\n\n    return true;\n  };\n\n  var timeIsValid = function timeIsValid() {\n    moment.locale('uk');\n    var now = moment();\n    var orderTime = moment(orderData.time * 1000);\n    var diff = orderTime.diff(now, 'minutes');\n    var delivery = appSettings.delivery || null;\n\n    if (delivery && delivery.min_delivery_time && diff < Number(delivery.min_delivery_time)) {\n      var errMessage = translator.translate(language, \"Час доставки не може бути раніше ніж поточний час + :MIN хвилин\");\n      errMessage = errMessage.replace(':MIN', delivery.min_delivery_time);\n      var errors = {\n        time: translator.translate(language, errMessage)\n      };\n      setValidationErrors(errors);\n      return false;\n    }\n\n    var schedule = delivery['schedule'];\n    if (typeof schedule !== 'object') return true;\n    var startTime = schedule['start'];\n    var endTime = schedule['end'];\n    if (!startTime || !endTime) return true;\n    var startTimeParts = startTime.split(':');\n    var endTimeParts = endTime.split(':');\n    var orderHour = orderTime.hour();\n    var orderMinutes = orderTime.minutes();\n\n    if (orderMinutes < 10) {\n      orderMinutes = '0' + orderMinutes;\n    } else if (orderMinutes === 0) {\n      orderMinutes = '00';\n    }\n\n    var startTimeNumber = parseInt(startTimeParts[0] + startTimeParts[1]);\n    var endTimeNumber = parseInt(endTimeParts[0] + endTimeParts[1]);\n\n    if (startTimeNumber > endTimeNumber) {\n      endTimeNumber += 2400;\n    }\n\n    var orderTimeNumber = parseInt(String(orderHour) + String(orderMinutes));\n\n    if (orderTimeNumber < startTimeNumber || orderTimeNumber > endTimeNumber) {\n      var _errMessage = \"Час доставки може бути в межах від :START до :END\";\n      _errMessage = _errMessage.replace(':START', startTime).replace(':END', endTime);\n      var _errors = {\n        time: translator.translate(language, _errMessage)\n      };\n      setValidationErrors(_errors);\n      return false;\n    }\n\n    return true;\n  };\n\n  var closeSuccessOrderModal = function closeSuccessOrderModal() {\n    setShowSuccessOrderModal(false);\n    clearOrderData();\n    clearCart();\n  };\n\n  var injectedJavascript = \"(document.body.addEventListener(\\n        'click', (e) => { \\n            if(e.target.closest('.button__verify')){\\n                setTimeout(() => {window.ReactNativeWebView.postMessage(document.body.innerHTML)}, 1500);\\n            } else if(e.target.closest('.cancel__payment')){\\n                window.ReactNativeWebView.postMessage('cancel payment');\\n            } else if (e.target.closest('.container__block__confirm__send')) {\\n                window.ReactNativeWebView.postMessage('email confirmation sent');\\n            } else if (e.target.closest('.button__return')) {\\n                window.ReactNativeWebView.postMessage('return button pressed');\\n            } else {\\n                window.ReactNativeWebView.postMessage('return other action');\\n            }\\n        })\\n    )\";\n\n  var refreshLastOrderAddress = function refreshLastOrderAddress() {\n    var newLastAddress = {\n      apartment_number: orderData.flat,\n      do_not_call: orderData.do_not_call,\n      entrance: orderData.enterence,\n      have_a_child: orderData.have_a_child,\n      have_a_dog: orderData.have_a_dog,\n      house_number: orderData.house,\n      city: orderData.city,\n      street: orderData.street\n    };\n    updateLastOrderAddress(newLastAddress);\n  };\n\n  var handleMessageFromWebView = function handleMessageFromWebView(data) {\n    if (data === 'cancel payment') {\n      setShowPaymentModal(false);\n      return;\n    }\n\n    if (data === 'return button pressed') {\n      setShowPaymentModal(false);\n      clearCart();\n      refreshLastOrderAddress();\n      return;\n    }\n\n    if (data === 'email confirmation sent') {\n      setShowPaymentModal(false);\n      clearCart();\n      refreshLastOrderAddress();\n      return;\n    }\n\n    var needle = /container__block__confirm__success__text/i;\n    var needleTwo = /MOJO HALL/i;\n    var hasNoErrors = false;\n    var errorBlock = data.substring(data.indexOf('hidable'), data.indexOf('autocomplete'));\n\n    if (errorBlock) {\n      if (errorBlock.indexOf('display: none') !== -1 || errorBlock.indexOf('display:none') !== -1) {\n        hasNoErrors = true;\n      }\n    }\n\n    var result = data.match(needle);\n    var resultTwo = data.match(needleTwo);\n\n    if (hasNoErrors) {\n      if (result || resultTwo) {\n        setIsOrderPaid(true);\n        refreshLastOrderAddress();\n      }\n    }\n  };\n\n  var handleClosePaymentModal = function handleClosePaymentModal() {\n    if (isOrderPaid) {\n      setShowPaymentModal(false);\n      clearCart();\n    } else {\n      setShowPaymentModal(false);\n\n      if (isWayForPaySystemUsed) {\n        setShowClearCartModal(true);\n      }\n    }\n  };\n\n  var handleNextStep = function handleNextStep() {\n    setShowOnlinePaymentInfoModal(false);\n    setTimeout(function () {\n      setShowPaymentModal(true);\n    }, 500);\n  };\n\n  var clearCartCallback = function clearCartCallback() {\n    clearCart();\n  };\n\n  var isWayForPay = function isWayForPay(payment_url) {\n    return setIsWayForPaySystemUsed(payment_url.includes('way-for-pay'));\n  };\n\n  return React.createElement(KeyboardAvoidingView, {\n    style: {\n      flex: 1\n    },\n    behavior: Platform.OS === 'ios' ? 'padding' : null,\n    enabled: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 564,\n      columnNumber: 9\n    }\n  }, React.createElement(SafeView, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 565,\n      columnNumber: 13\n    }\n  }, React.createElement(Header, {\n    backAllowed: true,\n    navigation: navigation,\n    title: translator.translate(language, \"Оформлення замовлення\"),\n    noIcons: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 566,\n      columnNumber: 17\n    }\n  }), React.createElement(View, {\n    style: styles(scales).body,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 572,\n      columnNumber: 17\n    }\n  }, !networkError || deliveryCitiesNetworkError ? !isDataFetching ? deliveryCities.length ? React.createElement(ScrollView, {\n    showsVerticalScrollIndicator: false,\n    bounces: false,\n    keyboardShouldPersistTaps: 'always',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 580,\n      columnNumber: 49\n    }\n  }, React.createElement(Block, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 582,\n      columnNumber: 53\n    }\n  }, React.createElement(Spacer, {\n    spaceHeight: 15,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 584,\n      columnNumber: 57\n    }\n  }), React.createElement(Text, {\n    style: styles(scales).title,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 585,\n      columnNumber: 57\n    }\n  }, translator.translate(language, \"Контактні дані\")), React.createElement(Spacer, {\n    spaceHeight: 10,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 587,\n      columnNumber: 57\n    }\n  }), React.createElement(SimpleInput, {\n    callback: handleFormInputs,\n    placeholder: translator.translate(language, \"Ім'я\"),\n    clearError: clearValidationErrors,\n    value: orderData.name,\n    name: \"name\",\n    error: validationErrors.name,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 588,\n      columnNumber: 57\n    }\n  }), React.createElement(Spacer, {\n    spaceHeight: 10,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 596,\n      columnNumber: 57\n    }\n  }), React.createElement(PhoneInput, {\n    callback: handlePhoneInput,\n    clearError: clearValidationErrors,\n    value: orderData.phone,\n    name: \"phone\",\n    placeholder: translator.translate(language, \"Телефон\"),\n    error: validationErrors.phone,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 597,\n      columnNumber: 57\n    }\n  }), React.createElement(Spacer, {\n    spaceHeight: 30,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 605,\n      columnNumber: 57\n    }\n  }), React.createElement(Text, {\n    style: styles(scales).title,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 608,\n      columnNumber: 57\n    }\n  }, translator.translate(language, \"Адреса доставки\")), React.createElement(Spacer, {\n    spaceHeight: 10,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 610,\n      columnNumber: 57\n    }\n  }), React.createElement(SelectInput, {\n    dataList: deliveryCities,\n    callback: handleFormInputs,\n    placeholder: translator.translate(language, \"Місто / населений пункт\"),\n    modalTitle: translator.translate(language, \"Виберіть місто / населений пункт\"),\n    clearError: clearValidationErrors,\n    defaultValue: orderData.city,\n    name: \"city\",\n    error: validationErrors.city,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 611,\n      columnNumber: 57\n    }\n  }), React.createElement(Spacer, {\n    spaceHeight: 10,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 621,\n      columnNumber: 57\n    }\n  }), orderData.city && orderData.city.id === 0 ? React.createElement(React.Fragment, null, React.createElement(SimpleInput, {\n    callback: handleFormInputs,\n    placeholder: translator.translate(language, \"Назва населеного пункту\"),\n    clearError: clearValidationErrors,\n    value: orderData.other_city_name,\n    name: \"other_city_name\",\n    error: validationErrors.other_city_name,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 626,\n      columnNumber: 73\n    }\n  }), React.createElement(Spacer, {\n    spaceHeight: 10,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 634,\n      columnNumber: 73\n    }\n  })) : null, React.createElement(SimpleInput, {\n    callback: handleFormInputs,\n    placeholder: translator.translate(language, \"Вулиця\"),\n    clearError: clearValidationErrors,\n    value: orderData.street,\n    name: \"street\",\n    error: validationErrors.street,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 639,\n      columnNumber: 57\n    }\n  }), React.createElement(Spacer, {\n    spaceHeight: 10,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 647,\n      columnNumber: 57\n    }\n  }), React.createElement(View, {\n    style: app_styles(scales).row_between,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 648,\n      columnNumber: 57\n    }\n  }, React.createElement(SimpleInput, {\n    callback: handleFormInputs,\n    clearError: clearValidationErrors,\n    placeholder: translator.translate(language, \"Під’їзд\"),\n    value: orderData.enterence,\n    name: \"enterence\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 649,\n      columnNumber: 61\n    }\n  }), React.createElement(VerticalSpacer, {\n    spaceWidth: 20,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 656,\n      columnNumber: 61\n    }\n  }), React.createElement(SimpleInput, {\n    callback: handleFormInputs,\n    placeholder: \"№ \" + translator.translate(language, \"будинку\"),\n    value: orderData.house,\n    error: validationErrors.house,\n    name: \"house\",\n    clearError: clearValidationErrors,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 657,\n      columnNumber: 61\n    }\n  })), React.createElement(Spacer, {\n    spaceHeight: 10,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 666,\n      columnNumber: 57\n    }\n  }), React.createElement(View, {\n    style: app_styles(scales).row_between_start,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 667,\n      columnNumber: 57\n    }\n  }, React.createElement(SimpleInput, {\n    callback: handleFormInputs,\n    placeholder: \"№ \" + translator.translate(language, \"квартири\"),\n    clearError: clearValidationErrors,\n    value: orderData.flat,\n    number: true,\n    name: \"flat\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 668,\n      columnNumber: 61\n    }\n  }), React.createElement(VerticalSpacer, {\n    spaceWidth: 20,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 676,\n      columnNumber: 61\n    }\n  }), React.createElement(DateTimePikerInput, {\n    scales: scales,\n    callback: handleFormInputs,\n    placeholder: translator.translate(language, \"Час доставки\"),\n    clearError: clearValidationErrors,\n    name: \"time\",\n    error: validationErrors.time,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 677,\n      columnNumber: 61\n    }\n  })), React.createElement(Spacer, {\n    spaceHeight: 10,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 686,\n      columnNumber: 57\n    }\n  }), React.createElement(SimpleInput, {\n    callback: handleFormInputs,\n    placeholder: translator.translate(language, \"Побажання до замовлення\"),\n    clearError: clearValidationErrors,\n    value: orderData.comment,\n    name: \"comment\",\n    error: validationErrors.comment,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 687,\n      columnNumber: 57\n    }\n  }), React.createElement(Spacer, {\n    spaceHeight: 30,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 695,\n      columnNumber: 57\n    }\n  }), React.createElement(Text, {\n    style: styles(scales).title,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 698,\n      columnNumber: 57\n    }\n  }, translator.translate(language, \"Деталі\")), React.createElement(Spacer, {\n    spaceHeight: 20,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 700,\n      columnNumber: 57\n    }\n  }), React.createElement(View, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 701,\n      columnNumber: 57\n    }\n  }, React.createElement(View, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 702,\n      columnNumber: 61\n    }\n  }, React.createElement(HorizontalDivider, {\n    height: 1,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 703,\n      columnNumber: 65\n    }\n  }), React.createElement(View, {\n    style: styles(scales).li_elem,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 704,\n      columnNumber: 65\n    }\n  }, React.createElement(View, {\n    style: styles(scales).icon_container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 705,\n      columnNumber: 69\n    }\n  }, React.createElement(IcoMoonIcon, {\n    name: \"mute\",\n    color: app_styles(scales).colors.app.blue,\n    size: Math.round(scales.widthScale * 22),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 706,\n      columnNumber: 73\n    }\n  })), React.createElement(View, {\n    style: styles(scales).text_container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 710,\n      columnNumber: 69\n    }\n  }, React.createElement(Text, {\n    style: styles(scales).li_text,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 711,\n      columnNumber: 73\n    }\n  }, translator.translate(language, \"Не дзвонити в двері\"))), React.createElement(ButtonToggler, {\n    callback: function callback() {\n      return handleFormInputs('do_not_call', !orderData.do_not_call);\n    },\n    isActive: orderData.do_not_call,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 714,\n      columnNumber: 69\n    }\n  })), React.createElement(HorizontalDivider, {\n    height: 1,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 720,\n      columnNumber: 65\n    }\n  }), React.createElement(View, {\n    style: styles(scales).li_elem,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 721,\n      columnNumber: 65\n    }\n  }, React.createElement(View, {\n    style: styles(scales).icon_container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 722,\n      columnNumber: 69\n    }\n  }, React.createElement(IcoMoonIcon, {\n    name: \"stroller\",\n    color: app_styles(scales).colors.app.blue,\n    size: Math.round(scales.widthScale * 23),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 723,\n      columnNumber: 73\n    }\n  })), React.createElement(View, {\n    style: styles(scales).text_container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 727,\n      columnNumber: 69\n    }\n  }, React.createElement(Text, {\n    style: styles(scales).li_text,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 728,\n      columnNumber: 73\n    }\n  }, translator.translate(language, \"У мене мала дитина (до 12 років)\"))), React.createElement(ButtonToggler, {\n    callback: function callback() {\n      return handleFormInputs('have_a_child', !orderData.have_a_child);\n    },\n    isActive: orderData.have_a_child,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 731,\n      columnNumber: 69\n    }\n  })), React.createElement(HorizontalDivider, {\n    height: 1,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 737,\n      columnNumber: 65\n    }\n  }), React.createElement(View, {\n    style: styles(scales).li_elem,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 738,\n      columnNumber: 65\n    }\n  }, React.createElement(View, {\n    style: styles(scales).icon_container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 739,\n      columnNumber: 69\n    }\n  }, React.createElement(IcoMoonIcon, {\n    name: \"dog\",\n    color: app_styles(scales).colors.app.blue,\n    size: Math.round(scales.widthScale * 22),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 740,\n      columnNumber: 73\n    }\n  })), React.createElement(View, {\n    style: styles(scales).text_container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 744,\n      columnNumber: 69\n    }\n  }, React.createElement(Text, {\n    style: styles(scales).li_text,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 745,\n      columnNumber: 73\n    }\n  }, translator.translate(language, \"У мене є собака\"))), React.createElement(ButtonToggler, {\n    callback: function callback() {\n      return handleFormInputs('have_a_dog', !orderData.have_a_dog);\n    },\n    isActive: orderData.have_a_dog,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 748,\n      columnNumber: 69\n    }\n  })), React.createElement(HorizontalDivider, {\n    height: 1,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 754,\n      columnNumber: 65\n    }\n  })), React.createElement(Spacer, {\n    spaceHeight: 30,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 756,\n      columnNumber: 61\n    }\n  }), React.createElement(Text, {\n    style: styles(scales).title,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 759,\n      columnNumber: 61\n    }\n  }, translator.translate(language, \"Спосіб оплати\")), React.createElement(Spacer, {\n    spaceHeight: 20,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 761,\n      columnNumber: 61\n    }\n  }), React.createElement(View, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 762,\n      columnNumber: 61\n    }\n  }, React.createElement(ButtonRadio, {\n    value: \"cash\",\n    isSelected: orderData.payment_type === 'cash' || false,\n    label: translator.translate(language, \"Оплата готівкою\"),\n    callback: handlePaymentMethod,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 763,\n      columnNumber: 65\n    }\n  }), React.createElement(Spacer, {\n    spaceHeight: 12,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 769,\n      columnNumber: 65\n    }\n  }), React.createElement(ButtonRadio, {\n    value: \"online\",\n    isSelected: orderData.payment_type === 'online' || false,\n    label: translator.translate(language, \"Оплата онлайн\"),\n    callback: handlePaymentMethod,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 770,\n      columnNumber: 65\n    }\n  })), React.createElement(Spacer, {\n    spaceHeight: 30,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 777,\n      columnNumber: 61\n    }\n  }), React.createElement(HorizontalDivider, {\n    height: 1,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 780,\n      columnNumber: 61\n    }\n  }), React.createElement(Spacer, {\n    spaceHeight: 15,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 781,\n      columnNumber: 61\n    }\n  }), React.createElement(View, {\n    style: app_styles(scales).row_between,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 782,\n      columnNumber: 61\n    }\n  }, React.createElement(Text, {\n    style: styles(scales).li_text,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 783,\n      columnNumber: 65\n    }\n  }, translator.translate(language, \"Товари\")), React.createElement(Text, {\n    style: styles(scales).li_text,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 785,\n      columnNumber: 65\n    }\n  }, prices.products_price ? formatPrice(language, prices.products_price + prices.extra_ingredients + prices.sauce_price) + ' ' + translator.translate(language, \"грн\") : '-')), prices.packing_price > 0 ? React.createElement(React.Fragment, null, React.createElement(Spacer, {\n    spaceHeight: 5,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 792,\n      columnNumber: 77\n    }\n  }), React.createElement(View, {\n    style: app_styles(scales).row_between,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 793,\n      columnNumber: 77\n    }\n  }, React.createElement(Text, {\n    style: styles(scales).li_text,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 794,\n      columnNumber: 81\n    }\n  }, translator.translate(language, \"Пакування\")), React.createElement(Text, {\n    style: styles(scales).li_text,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 796,\n      columnNumber: 81\n    }\n  }, prices.packing_price ? formatPrice(language, prices.packing_price) + ' ' + translator.translate(language, \"грн\") : '-'))) : null, React.createElement(Spacer, {\n    spaceHeight: 5,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 803,\n      columnNumber: 61\n    }\n  }), React.createElement(View, {\n    style: [app_styles(scales).row_between, {\n      alignItems: 'flex-start'\n    }],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 804,\n      columnNumber: 61\n    }\n  }, React.createElement(Text, {\n    style: styles(scales).li_text,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 806,\n      columnNumber: 65\n    }\n  }, translator.translate(language, \"Доставка\")), React.createElement(Text, {\n    style: styles(scales).li_text,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 808,\n      columnNumber: 65\n    }\n  }, prices.delivery_price ? formatPrice(language, prices.delivery_price) + ' ' + translator.translate(language, \"грн\") : translator.translate(language, 'безкоштовно'))), React.createElement(Spacer, {\n    spaceHeight: 5,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 812,\n      columnNumber: 61\n    }\n  }), React.createElement(View, {\n    style: app_styles(scales).row_between,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 813,\n      columnNumber: 61\n    }\n  }, React.createElement(Text, {\n    style: styles(scales).total_title,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 814,\n      columnNumber: 65\n    }\n  }, translator.translate(language, \"Разом до оплати\")), React.createElement(Text, {\n    style: styles(scales).total_price,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 816,\n      columnNumber: 65\n    }\n  }, formatPrice(language, prices.total_price), \" \", translator.translate(language, \"грн\"))), React.createElement(Spacer, {\n    spaceHeight: 15,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 820,\n      columnNumber: 61\n    }\n  }), React.createElement(HorizontalDivider, {\n    height: 1,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 821,\n      columnNumber: 61\n    }\n  }), React.createElement(Spacer, {\n    spaceHeight: 30,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 822,\n      columnNumber: 61\n    }\n  }), React.createElement(ButtonPrimary, {\n    callback: formSubmit,\n    title: translator.translate(language, \"Замовити\"),\n    color: app_styles(scales).colors.app.blue,\n    isDataLoading: isDataLoading,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 823,\n      columnNumber: 61\n    }\n  })), React.createElement(Spacer, {\n    spaceHeight: 44,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 830,\n      columnNumber: 57\n    }\n  }))) : null : React.createElement(DataLoadingIndicator, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 835,\n      columnNumber: 39\n    }\n  }) : React.createElement(NetworkErrorModal, {\n    isOpened: networkError,\n    closeCallback: networkError ? clearNetworkError : clearDeliveryCitiesNetworkError,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 837,\n      columnNumber: 31\n    }\n  }))), React.createElement(SuccessOrderModal, {\n    isOpened: showSuccessOrderModal,\n    closeCallback: closeSuccessOrderModal,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 846,\n      columnNumber: 13\n    }\n  }), React.createElement(OnlinePaymentInfoModal, {\n    isOpened: showOnlinePaymentInfoModal,\n    nextCallback: function nextCallback() {\n      return handleNextStep();\n    },\n    cancelCallback: function cancelCallback() {\n      return setShowOnlinePaymentInfoModal(false);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 852,\n      columnNumber: 13\n    }\n  }), React.createElement(ClearCartModal, {\n    isOpened: showClearCartModal,\n    clearCallback: function clearCallback() {\n      return clearCartCallback();\n    },\n    cancelCallback: function cancelCallback() {\n      return setShowClearCartModal(false);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 859,\n      columnNumber: 13\n    }\n  }), React.createElement(Modal, {\n    animationType: \"fade\",\n    transparent: false,\n    visible: showPaymentModal,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 866,\n      columnNumber: 13\n    }\n  }, React.createElement(View, {\n    style: styles(scales).modal_content_container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 871,\n      columnNumber: 17\n    }\n  }, React.createElement(View, {\n    style: styles(scales).modal_card,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 873,\n      columnNumber: 21\n    }\n  }, React.createElement(WebView, {\n    source: {\n      uri: paymentWidgetHtml\n    },\n    bounces: true,\n    style: {\n      flex: 1\n    },\n    injectedJavaScript: injectedJavascript,\n    startInLoadingState: true,\n    javaScriptEnabledAndroid: true,\n    javaScriptEnabled: true,\n    onMessage: function onMessage(event) {\n      handleMessageFromWebView(event.nativeEvent.data);\n    },\n    useWebKit: Platform.OS === 'ios' ? true : false,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 875,\n      columnNumber: 25\n    }\n  }), React.createElement(HorizontalDivider, {\n    height: 1,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 888,\n      columnNumber: 25\n    }\n  }), React.createElement(TouchableOpacity, {\n    onPress: handleClosePaymentModal,\n    style: styles(scales).close_modal_button_container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 890,\n      columnNumber: 25\n    }\n  }, React.createElement(View, {\n    style: styles(scales).modal_card_footer,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 892,\n      columnNumber: 29\n    }\n  }, React.createElement(Text, {\n    style: styles(scales).footer_title,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 893,\n      columnNumber: 33\n    }\n  }, translator.translate(language, \"закрити\"))))))));\n};\n\nexport default MakeOrderScreen;","map":{"version":3,"sources":["/home/alex/workspace/papamama/src/screens/MakeOrderScreen.js"],"names":["React","useEffect","useState","useContext","WebView","Context","AppSettingsContext","AuthContext","MenuContext","createIconSetFromIcoMoon","icoMoonConfig","IcoMoonIcon","moment","Header","SafeView","Block","Spacer","DataLoadingIndicator","VerticalSpacer","HorizontalDivider","NetworkErrorModal","SuccessOrderModal","OnlinePaymentInfoModal","ClearCartModal","ButtonPrimary","ButtonRadio","ButtonToggler","PhoneInput","SelectInput","SimpleInput","DateTimePikerInput","formatPrice","reformatUserPhone","translator","styles","app_styles","MakeOrderScreen","navigation","state","scales","language","deliveryCities","deliveryCitiesNetworkError","isDataFetching","appSettings","homeCityId","getDeliveryCities","clearDeliveryCitiesNetworkError","user","isLoggedIn","last_order_address","setFromMakeOrder","writeOffBonuses","updateLastOrderAddress","updateUserData","cart","validationErrors","networkError","paymentWidgetHtml","clearValidationErrors","clearNetworkError","clearAllValidationsErrors","setValidationErrors","makeOrder","clearCart","isDataLoading","setIsDataLoading","name","username","phone","city","other_city_name","street","enterence","entrance","house","house_number","flat","apartment_number","time","comment","payment_type","do_not_call","parseInt","have_a_child","have_a_dog","orderData","setOrderData","packing_price","delivery_price","products_price","total_price","sauce_price","extra_ingredients","prices","setPrices","showSuccessOrderModal","setShowSuccessOrderModal","showPaymentModal","setShowPaymentModal","showOnlinePaymentInfoModal","setShowOnlinePaymentInfoModal","showClearCartModal","setShowClearCartModal","isOrderPaid","setIsOrderPaid","lowOrederSum","setLowOrderSum","isWayForPaySystemUsed","setIsWayForPaySystemUsed","length","fetchDelivrySities","calculatePrices","handlePhoneInput","value","autocompletePhone","clearOrderData","setCustomerPhone","refactorCurrentPhoneValue","phoneNumber","substring","charPositions","symbol","splitedVal","split","i","substr","handleFormInputs","handlePaymentMethod","getSauceValue","product","properties","sauce","size","price2","price","packingPrice","productsPrice","deliveryPrice","extraIngredients","saucePrice","forEach","item","hasIngredients","main_ingredients","ingr","checked","parseFloat","quantity","Number","getProductPrice","getProductPackingPrice","deliveryInfo","delivery","totalVal","id","secondary","main","category","has_ingredients","variant","variants","find","formSubmit","requiredFields","hasEmptyFields","validatePhoneLength","timeIsValid","minimumOrderSum","alertMessage","translate","replace","Alert","alert","cleanedPhone","form","inputs","email","city_id","city_name","transformCartForOrder","response","payment_url","isWayForPay","refreshLastOrderAddress","cartForOrder","position","transformIngredients","property_id","type","product_id","push","data","result","ingredient_id","errors","key","includes","Object","keys","locale","now","orderTime","diff","min_delivery_time","errMessage","schedule","startTime","endTime","startTimeParts","endTimeParts","orderHour","hour","orderMinutes","minutes","startTimeNumber","endTimeNumber","orderTimeNumber","String","closeSuccessOrderModal","injectedJavascript","newLastAddress","handleMessageFromWebView","needle","needleTwo","hasNoErrors","errorBlock","indexOf","match","resultTwo","handleClosePaymentModal","handleNextStep","setTimeout","clearCartCallback","flex","Platform","OS","body","title","row_between","row_between_start","li_elem","icon_container","colors","app","blue","Math","round","widthScale","text_container","li_text","alignItems","total_title","modal_content_container","modal_card","uri","event","nativeEvent","close_modal_button_container","modal_card_footer","footer_title"],"mappings":"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","sourcesContent":["//----IMPORTS----//\n//React\nimport React, {useEffect, useState, useContext} from 'react';\n//React native\nimport {View, Text, KeyboardAvoidingView, ScrollView, Alert, Modal, TouchableOpacity} from 'react-native';\n//WebView\nimport {WebView} from 'react-native-webview';\n//Context\nimport {Context as AppSettingsContext} from \"../context/AppSettingsContext\";\nimport {Context as AuthContext} from \"../context/AuthContext\";\nimport {Context as MenuContext} from \"../context/MenuContext\";\n//React-native-vector-icons package\nimport {createIconSetFromIcoMoon} from 'react-native-vector-icons';\nimport icoMoonConfig from '../../selection.json';\n\nconst IcoMoonIcon = createIconSetFromIcoMoon(icoMoonConfig, 'icomoon', 'icomoon.ttf');\n//Moment\nimport moment from \"moment\";\nimport 'moment/locale/uk';\n//Components\nimport Header from \"../components/shared/Header\";\nimport {SafeView, Block, Spacer, DataLoadingIndicator, VerticalSpacer, HorizontalDivider} from \"../components/shared\";\nimport {NetworkErrorModal, SuccessOrderModal, OnlinePaymentInfoModal, ClearCartModal} from \"../components/modals\";\nimport {ButtonPrimary, ButtonRadio, ButtonToggler} from \"../components/buttons\";\nimport {PhoneInput, SelectInput, SimpleInput, DateTimePikerInput} from \"../components/inputs\";\n//Helpers\nimport {formatPrice, reformatUserPhone} from \"../helpers/helpers\";\n//Localization\nimport translator from \"../translator/translator\";\n//Styles\nimport styles from '../styles/screens/make-order-screen';\nimport {app_styles} from '../styles/app_styles';\n\n\n//----COMPONENT----//\nconst MakeOrderScreen = ({navigation}) => {\n    //Data and State\n    const {state: {scales, language, deliveryCities, deliveryCitiesNetworkError, isDataFetching, appSettings, homeCityId}, getDeliveryCities, clearDeliveryCitiesNetworkError} = useContext(AppSettingsContext);\n    const {state: {user, isLoggedIn, last_order_address}, setFromMakeOrder, writeOffBonuses, updateLastOrderAddress, updateUserData} = useContext(AuthContext);\n    const {state: {cart, validationErrors, networkError, paymentWidgetHtml}, clearValidationErrors, clearNetworkError, clearAllValidationsErrors, setValidationErrors, makeOrder, clearCart} = useContext(MenuContext);\n    const [isDataLoading, setIsDataLoading] = useState(false);\n    const [orderData, setOrderData] = useState({\n        name: (user.name || user.username) ? (user.name || user.username) : null,\n        phone: user.phone ? reformatUserPhone(user.phone) : null,\n        city: (last_order_address.city && last_order_address.city !== 'null') ? last_order_address.city : null,\n        other_city_name: null,\n        street: (last_order_address.street && last_order_address.street !== 'null') ? last_order_address.street : null,\n        enterence: (last_order_address.entrance && last_order_address.entrance) !== 'null' ? last_order_address.entrance : null,\n        house: (last_order_address.house_number && last_order_address.house_number) !== 'null' ? last_order_address.house_number : null,\n        flat: (last_order_address.apartment_number && last_order_address.apartment_number !== 'null') ? last_order_address.apartment_number : null,\n        time: null,\n        comment: null,\n        payment_type: 'cash', //or 'online // 1 - cash 2 - online\n        do_not_call: (last_order_address.do_not_call && last_order_address.do_not_call !== 'null') ? parseInt(last_order_address.do_not_call) : 0,\n        have_a_child: (last_order_address.have_a_child && last_order_address.have_a_child !== 'null') ? parseInt(last_order_address.have_a_child) : 0,\n        have_a_dog: (last_order_address.have_a_dog && last_order_address.have_a_dog !== 'null') ? parseInt(last_order_address.have_a_dog) : 0,\n    });\n    const [prices, setPrices] = useState({\n        packing_price: 0,\n        delivery_price: 0,\n        products_price: 0,\n        total_price: 0,\n        sauce_price: 0,\n        extra_ingredients: 0\n    });\n    const [showSuccessOrderModal, setShowSuccessOrderModal] = useState(false)\n    const [showPaymentModal, setShowPaymentModal] = useState(false)\n    const [showOnlinePaymentInfoModal, setShowOnlinePaymentInfoModal] = useState(false)\n    const [showClearCartModal, setShowClearCartModal] = useState(false)\n    const [isOrderPaid, setIsOrderPaid] = useState(false)\n    const [lowOrederSum, setLowOrderSum] = useState(false);\n    const [isWayForPaySystemUsed, setIsWayForPaySystemUsed] = useState(false);\n\n\n    //Hooks and Methods\n    useEffect(() => {\n        if (!deliveryCities.length) {\n            fetchDelivrySities()\n        }\n\n        calculatePrices();\n\n        return () => {\n            clearAllValidationsErrors()\n        }\n    }, [orderData, paymentWidgetHtml]);\n\n\n    /*Customer input handler*/\n    const handlePhoneInput = (value) => {\n        autocompletePhone(value)\n    }\n\n    const clearOrderData = () => {\n        setOrderData({\n            ...orderData,\n            city: null,\n            street: null,\n            enterence: null,\n            house: null,\n            flat: null,\n            time: null,\n            comment: null,\n        })\n    }\n\n    const fetchDelivrySities = async () => {\n        await getDeliveryCities();\n    }\n\n    /*For formating phone number according to design*/\n    const autocompletePhone = (value) => {\n        if (value !== null && value.length <= 5) {\n            setCustomerPhone(\"+380 \");\n        } else {\n            if (value === null) {\n                setCustomerPhone(null);\n                return;\n            }\n            if (value.length <= 17) {\n                refactorCurrentPhoneValue(value, [7, 11, 14], \" \");\n            } else if (value.length > 17) {\n                refactorCurrentPhoneValue(value, [7, 11, 14], \" \");\n                let phoneNumber = orderData.phone.substring(0, 17);\n                setCustomerPhone(phoneNumber);\n            }\n        }\n    }\n\n    /*Used in handlePhoneInput method*/\n    const refactorCurrentPhoneValue = (value, charPositions, symbol) => {\n        let splitedVal = value.split(\"\");\n\n        for (let i = 0; i < charPositions.length; i++) {\n            if (\n                splitedVal[charPositions[i]] &&\n                splitedVal[charPositions[i]] !== symbol\n            ) {\n                let phoneNumber = orderData.phone.substring(0, charPositions[i]) + symbol + orderData.phone.substring(charPositions[i]) + value.substr(-1, 1);\n                setCustomerPhone(phoneNumber);\n                return;\n            } else {\n                setCustomerPhone(value);\n            }\n        }\n    }\n\n    /*For avoiding code dublication*/\n    const setCustomerPhone = (value) => {\n        setOrderData({...orderData, phone: value});\n    }\n\n    const handleFormInputs = (name, value) => {\n        setOrderData({...orderData, [name]: value});\n    }\n\n    const handlePaymentMethod = (value) => {\n        setOrderData({...orderData, payment_type: value})\n    }\n\n    const getSauceValue = (product) => {\n        if (!product.properties || !product.properties.length ) return;\n        if (!product.sauce) return 0;\n        return product.size === 2 ? product.sauce.price2 : product.sauce.price;\n    }\n\n    const calculatePrices = () => {\n        let packingPrice = 0;\n        let productsPrice = 0;\n        let deliveryPrice = 0;\n        let extraIngredients = 0;\n        let saucePrice = 0;\n\n\n        cart.forEach(item => {\n            if (hasIngredients(item)) {\n                let value = 0;\n                item.main_ingredients.forEach(ingr => {\n                    if (ingr.checked) {\n                        value += (parseFloat(ingr.quantity) * parseFloat(ingr.price))\n                    }\n                });\n                extraIngredients += (value * item.quantity);\n            }\n\n            if(item.sauce){\n                saucePrice += getSauceValue(item) * Number(item.quantity);\n            }\n\n            productsPrice += (Number(item.quantity) * getProductPrice(item));\n            packingPrice += (Number(item.quantity) * getProductPackingPrice(item));\n        });\n\n\n        //If order sum (products + packaging) lower than minimal for chosen city - order is not possible\n        if (orderData.city) {\n            let deliveryInfo = appSettings.delivery;\n            let totalVal = productsPrice + packingPrice + extraIngredients;\n\n            if (Number(orderData.city.id) !== homeCityId) {\n                let secondary = deliveryInfo['secondary'];\n\n                if (totalVal >= Number(secondary['min_sum_for_promo_delivery'])) {\n                    deliveryPrice = Number(secondary['promo_delivery_price']);\n                } else {\n                    deliveryPrice = Number(secondary['price']);\n                }\n\n                if (totalVal < secondary['min_order_price']) {\n                    setLowOrderSum(true);\n                } else {\n                    setLowOrderSum(false);\n                }\n            } else {\n                let main = deliveryInfo['main'];\n                if (totalVal < Number(main['min_free_delivery_sum'])) {\n                    deliveryPrice = Number(main['price'])\n                }\n                if (totalVal < main['min_order_price']) {\n                    setLowOrderSum(true);\n                } else {\n                    setLowOrderSum(false);\n                }\n            }\n        }\n\n        let total_price = packingPrice + productsPrice + extraIngredients + deliveryPrice + saucePrice;\n\n        setPrices({\n            packing_price: packingPrice,\n            delivery_price: deliveryPrice,\n            products_price: productsPrice,\n            extra_ingredients: extraIngredients,\n            sauce_price: saucePrice,\n            total_price\n        });\n\n    }\n\n    const hasIngredients = (product) => {\n        return !!product.category.has_ingredients;\n    }\n\n    const getProductPrice = (product) => {\n        let variant = product.variants.find(item => item.size === product.size);\n        return variant ? parseFloat(variant['price']) : product.variants[0]['price'];\n    }\n\n    const getProductPackingPrice = (product) => {\n        return (product.category && product.category.packing_price) ? parseFloat(product.category.packing_price) : 0;\n    }\n\n    const formSubmit = async () => {\n        try {\n            let requiredFields = (orderData.city && orderData.city.id === 0)\n                ? ['name', 'phone', 'other_city_name', 'street', 'house', 'time']\n                : ['name', 'phone', 'city', 'street', 'house', 'time'];\n            if (hasEmptyFields(orderData, requiredFields)) return;\n            if (!validatePhoneLength()) return;\n            if (!timeIsValid()) return;\n            if (lowOrederSum) {\n                let deliveryInfo = appSettings.delivery;\n                let minimumOrderSum = orderData.city.id === homeCityId ? deliveryInfo['main']['min_order_price'] : deliveryInfo['secondary']['min_order_price'];\n                let alertMessage = translator.translate(language, \"Мінімальна сума замовлення для Вашого населеного пункту становить :SUM грн.\");\n                alertMessage = alertMessage.replace(/:SUM/, formatPrice(language, minimumOrderSum));\n                return Alert.alert(translator.translate(language, \"Увага!\"), alertMessage)\n            }\n            setIsDataLoading(true);\n            let cleanedPhone = orderData.phone.replace(/\\s/g, '');\n\n            let form = {\n                inputs: {\n                    name: orderData.name,\n                    email: user.email,\n                    phone: cleanedPhone,\n                    city_id: orderData.city.id,\n                    city_name: orderData.other_city_name || orderData.city.name,\n                    street: orderData.street,\n                    house_number: orderData.house,\n                    payment_type: orderData.payment_type === 'cash' ? 1 : 2,\n                    time: orderData.time,\n                    do_not_call: orderData.do_not_call ? 1 : 0,\n                    have_a_child: orderData.have_a_child ? 1 : 0,\n                    have_a_dog: orderData.have_a_dog ? 1 : 0,\n                },\n                cart: transformCartForOrder()\n            }\n\n            if (orderData.enterence) {\n                form.inputs.entrance = orderData.enterence;\n            }\n\n            if (orderData.flat) {\n                form.inputs.apartment_number = orderData.flat;\n            }\n\n            if (orderData.comment) {\n                form.inputs.comment = orderData.comment;\n            }\n\n            let response = await makeOrder(form);\n\n            if (response.payment_url) {\n                isWayForPay(response.payment_url);\n                setShowOnlinePaymentInfoModal(true)\n            } else {\n                refreshLastOrderAddress();\n                setShowSuccessOrderModal(true);\n                if (!user.phone) {\n                    updateUserData('phone', orderData.phone)\n                }\n            }\n            setLowOrderSum(false);\n            setIsDataLoading(false)\n        } catch (error) {\n            setIsDataLoading(false);\n        }\n    }\n\n    const transformCartForOrder = () => {\n        let cartForOrder = [];\n\n        cart.forEach(item => {\n            let position = {};\n            if (item.category.has_ingredients) {\n                position.main_ingredients = transformIngredients(item.main_ingredients)\n            }\n            if(item.sauce){\n               position.property_id = item.sauce.id;\n            }\n            position.type = item.type;\n            position.product_id = item.id;\n            position.quantity = item.quantity\n            position.size = item.size || 1;\n\n            if (item.comment) {\n                position.comment = item.comment\n            }\n\n            cartForOrder.push(position)\n        })\n\n        return cartForOrder;\n\n        function transformIngredients(data) {\n            let result = [];\n            data.forEach(item => {\n                if (item.checked && item.checked === 1) {\n                    let position = {\n                        ingredient_id: item.id,\n                        quantity: item.quantity\n                    }\n                    result.push(position)\n                }\n            });\n            return result;\n        }\n    }\n\n    const hasEmptyFields = (data, requiredFields) => {\n        let errors = {};\n        for (let key in data) {\n            if (requiredFields.includes(key) && !data[key]) {\n                errors[key] = translator.translate(language, \"Поле не може бути порожнім!\")\n            }\n        }\n        if (Object.keys(errors).length) {\n            setValidationErrors(errors);\n            return true;\n        }\n        return false;\n    }\n\n    const validatePhoneLength = () => {\n        if(!orderData.phone) return;\n        if(orderData.phone.length < 17){\n            setValidationErrors({\n                phone: translator.translate(language, \"Перевірте правильність введеного номеру телефону\")\n            });\n            return false;\n        }\n        return true;\n    }\n\n    const timeIsValid = () => {\n        moment.locale('uk');\n        let now = moment();\n        let orderTime = moment(orderData.time * 1000);\n        let diff = orderTime.diff(now, 'minutes');\n\n\n\n        let delivery = appSettings.delivery || null;\n\n        if (delivery && delivery.min_delivery_time && (diff < Number(delivery.min_delivery_time))) {\n            let errMessage = translator.translate(language, \"Час доставки не може бути раніше ніж поточний час + :MIN хвилин\");\n            errMessage = errMessage.replace(':MIN', delivery.min_delivery_time);\n            let errors = {\n                time: translator.translate(language, errMessage)\n            }\n            setValidationErrors(errors);\n            return false;\n        }\n\n        let schedule = delivery['schedule'];\n\n        if (typeof schedule !== 'object') return true; //True just for letting request go to server\n\n        let startTime = schedule['start'];\n        let endTime = schedule['end'];\n\n        if (!startTime || !endTime) return true; //True just for letting request go to server\n\n        let startTimeParts = startTime.split(':');\n\n        let endTimeParts = endTime.split(':');\n\n        let orderHour = orderTime.hour();\n        let orderMinutes = orderTime.minutes();\n\n        if (orderMinutes < 10){\n            orderMinutes = '0' + orderMinutes;\n        } else if (orderMinutes === 0) {\n            orderMinutes = '00';\n        }\n\n        let startTimeNumber = parseInt(startTimeParts[0] + startTimeParts[1]);\n        let endTimeNumber = parseInt(endTimeParts[0] + endTimeParts[1]);\n\n        if(startTimeNumber > endTimeNumber) {\n            endTimeNumber += 2400; //That means delivery works for some hours of the next day\n        }\n\n        let orderTimeNumber = parseInt(String(orderHour) + String(orderMinutes));\n\n        if(orderTimeNumber < startTimeNumber || orderTimeNumber > endTimeNumber){\n            let errMessage = \"Час доставки може бути в межах від :START до :END\";\n            errMessage = errMessage\n                .replace(':START', startTime)\n                .replace(':END', endTime);\n\n            let errors = {\n                time: translator.translate(language, errMessage)\n            }\n            setValidationErrors(errors);\n            return false;\n        }\n\n        return true;\n    }\n\n    const closeSuccessOrderModal = () => {\n        setShowSuccessOrderModal(false);\n        clearOrderData();\n        clearCart();\n    }\n\n    /**\n     * JS injected in WebView for checking customer actions\n     */\n    const injectedJavascript = `(document.body.addEventListener(\n        'click', (e) => { \n            if(e.target.closest('.button__verify')){\n                setTimeout(() => {window.ReactNativeWebView.postMessage(document.body.innerHTML)}, 1500);\n            } else if(e.target.closest('.cancel__payment')){\n                window.ReactNativeWebView.postMessage('cancel payment');\n            } else if (e.target.closest('.container__block__confirm__send')) {\n                window.ReactNativeWebView.postMessage('email confirmation sent');\n            } else if (e.target.closest('.button__return')) {\n                window.ReactNativeWebView.postMessage('return button pressed');\n            } else {\n                window.ReactNativeWebView.postMessage('return other action');\n            }\n        })\n    )`;\n\n    const refreshLastOrderAddress = () => {\n        let newLastAddress = {\n            apartment_number: orderData.flat,\n            do_not_call: orderData.do_not_call,\n            entrance: orderData.enterence,\n            have_a_child: orderData.have_a_child,\n            have_a_dog: orderData.have_a_dog,\n            house_number: orderData.house,\n            city: orderData.city,\n            street: orderData.street,\n        }\n        updateLastOrderAddress(newLastAddress);\n    }\n\n    const handleMessageFromWebView = (data) => {\n        if (data === 'cancel payment') {\n            setShowPaymentModal(false);\n            return;\n        }\n        if (data === 'return button pressed') {\n            setShowPaymentModal(false);\n            clearCart();\n            refreshLastOrderAddress();\n            return;\n        }\n        if (data === 'email confirmation sent') {\n            setShowPaymentModal(false);\n            clearCart();\n            refreshLastOrderAddress();\n            return;\n        }\n\n        let needle = /container__block__confirm__success__text/i;\n        let needleTwo = /MOJO HALL/i;\n        let hasNoErrors = false;\n\n        let errorBlock = data.substring(data.indexOf('hidable'), data.indexOf('autocomplete'));\n        if (errorBlock) {\n            if ((errorBlock.indexOf('display: none') !== -1) || (errorBlock.indexOf('display:none') !== -1)) {\n                hasNoErrors = true;\n            }\n        }\n\n        let result = data.match(needle);\n        let resultTwo = data.match(needleTwo);\n\n\n        if (hasNoErrors) {\n            if (result || resultTwo) {\n                setIsOrderPaid(true)\n                refreshLastOrderAddress();\n            }\n        }\n    }\n\n    const handleClosePaymentModal = () => {\n        if (isOrderPaid) {\n            setShowPaymentModal(false);\n            clearCart();\n        } else {\n            setShowPaymentModal(false)\n            if(isWayForPaySystemUsed){\n                setShowClearCartModal(true);\n            }\n        }\n    }\n\n    const handleNextStep = () => {\n        setShowOnlinePaymentInfoModal(false)\n        setTimeout(() => {\n            setShowPaymentModal(true)\n        }, 500)\n    }\n\n\n    const clearCartCallback = () => {\n        clearCart();\n    }\n\n    const isWayForPay = (payment_url) => {\n        return setIsWayForPaySystemUsed(payment_url.includes('way-for-pay'));\n    }\n\n\n\n    //Tempalte\n    return (\n        <KeyboardAvoidingView style={{flex: 1}} behavior={Platform.OS === 'ios' ? 'padding' : null} enabled>\n            <SafeView>\n                <Header\n                    backAllowed\n                    navigation={navigation}\n                    title={translator.translate(language, \"Оформлення замовлення\")}\n                    noIcons\n                />\n                <View style={styles(scales).body}>\n                    {\n                        !networkError || deliveryCitiesNetworkError\n                            ? (\n                                !isDataFetching\n                                    ? (\n                                        deliveryCities.length\n                                            ? (\n                                                <ScrollView showsVerticalScrollIndicator={false} bounces={false}\n                                                            keyboardShouldPersistTaps={'always'}>\n                                                    <Block>\n                                                        {/* Contact Information */}\n                                                        <Spacer spaceHeight={15}/>\n                                                        <Text\n                                                            style={styles(scales).title}>{translator.translate(language, \"Контактні дані\")}</Text>\n                                                        <Spacer spaceHeight={10}/>\n                                                        <SimpleInput\n                                                            callback={handleFormInputs}\n                                                            placeholder={translator.translate(language, \"Ім'я\")}\n                                                            clearError={clearValidationErrors}\n                                                            value={orderData.name}\n                                                            name=\"name\"\n                                                            error={validationErrors.name}\n                                                        />\n                                                        <Spacer spaceHeight={10}/>\n                                                        <PhoneInput\n                                                            callback={handlePhoneInput}\n                                                            clearError={clearValidationErrors}\n                                                            value={orderData.phone}\n                                                            name=\"phone\"\n                                                            placeholder={translator.translate(language, \"Телефон\")}\n                                                            error={validationErrors.phone}\n                                                        />\n                                                        <Spacer spaceHeight={30}/>\n\n                                                        {/* Delivery Details */}\n                                                        <Text\n                                                            style={styles(scales).title}>{translator.translate(language, \"Адреса доставки\")}</Text>\n                                                        <Spacer spaceHeight={10}/>\n                                                        <SelectInput\n                                                            dataList={deliveryCities}\n                                                            callback={handleFormInputs}\n                                                            placeholder={translator.translate(language, \"Місто / населений пункт\")}\n                                                            modalTitle={translator.translate(language, \"Виберіть місто / населений пункт\")}\n                                                            clearError={clearValidationErrors}\n                                                            defaultValue={orderData.city}\n                                                            name=\"city\"\n                                                            error={validationErrors.city}\n                                                        />\n                                                        <Spacer spaceHeight={10}/>\n                                                        {\n                                                            orderData.city && orderData.city.id === 0\n                                                                ? (\n                                                                    <>\n                                                                        <SimpleInput\n                                                                            callback={handleFormInputs}\n                                                                            placeholder={translator.translate(language, \"Назва населеного пункту\")}\n                                                                            clearError={clearValidationErrors}\n                                                                            value={orderData.other_city_name}\n                                                                            name=\"other_city_name\"\n                                                                            error={validationErrors.other_city_name}\n                                                                        />\n                                                                        <Spacer spaceHeight={10}/>\n                                                                    </>\n                                                                )\n                                                                : null\n                                                        }\n                                                        <SimpleInput\n                                                            callback={handleFormInputs}\n                                                            placeholder={translator.translate(language, \"Вулиця\")}\n                                                            clearError={clearValidationErrors}\n                                                            value={orderData.street}\n                                                            name=\"street\"\n                                                            error={validationErrors.street}\n                                                        />\n                                                        <Spacer spaceHeight={10}/>\n                                                        <View style={app_styles(scales).row_between}>\n                                                            <SimpleInput\n                                                                callback={handleFormInputs}\n                                                                clearError={clearValidationErrors}\n                                                                placeholder={translator.translate(language, \"Під’їзд\")}\n                                                                value={orderData.enterence}\n                                                                name=\"enterence\"\n                                                            />\n                                                            <VerticalSpacer spaceWidth={20}/>\n                                                            <SimpleInput\n                                                                callback={handleFormInputs}\n                                                                placeholder={\"№ \" + translator.translate(language, \"будинку\")}\n                                                                value={orderData.house}\n                                                                error={validationErrors.house}\n                                                                name=\"house\"\n                                                                clearError={clearValidationErrors}\n                                                            />\n                                                        </View>\n                                                        <Spacer spaceHeight={10}/>\n                                                        <View style={app_styles(scales).row_between_start}>\n                                                            <SimpleInput\n                                                                callback={handleFormInputs}\n                                                                placeholder={\"№ \" + translator.translate(language, \"квартири\")}\n                                                                clearError={clearValidationErrors}\n                                                                value={orderData.flat}\n                                                                number\n                                                                name=\"flat\"\n                                                            />\n                                                            <VerticalSpacer spaceWidth={20}/>\n                                                            <DateTimePikerInput\n                                                                scales={scales}\n                                                                callback={handleFormInputs}\n                                                                placeholder={translator.translate(language, \"Час доставки\")}\n                                                                clearError={clearValidationErrors}\n                                                                name=\"time\"\n                                                                error={validationErrors.time}\n                                                            />\n                                                        </View>\n                                                        <Spacer spaceHeight={10}/>\n                                                        <SimpleInput\n                                                            callback={handleFormInputs}\n                                                            placeholder={translator.translate(language, \"Побажання до замовлення\")}\n                                                            clearError={clearValidationErrors}\n                                                            value={orderData.comment}\n                                                            name=\"comment\"\n                                                            error={validationErrors.comment}\n                                                        />\n                                                        <Spacer spaceHeight={30}/>\n\n                                                        {/* Details */}\n                                                        <Text\n                                                            style={styles(scales).title}>{translator.translate(language, \"Деталі\")}</Text>\n                                                        <Spacer spaceHeight={20}/>\n                                                        <View>\n                                                            <View>\n                                                                <HorizontalDivider height={1}/>\n                                                                <View style={styles(scales).li_elem}>\n                                                                    <View style={styles(scales).icon_container}>\n                                                                        <IcoMoonIcon name=\"mute\"\n                                                                                     color={app_styles(scales).colors.app.blue}\n                                                                                     size={Math.round(scales.widthScale * 22)}/>\n                                                                    </View>\n                                                                    <View style={styles(scales).text_container}>\n                                                                        <Text\n                                                                            style={styles(scales).li_text}>{translator.translate(language, \"Не дзвонити в двері\")}</Text>\n                                                                    </View>\n                                                                    <ButtonToggler\n                                                                        callback={() => handleFormInputs('do_not_call', !orderData.do_not_call)}\n                                                                        isActive={orderData.do_not_call}\n                                                                    />\n                                                                </View>\n\n                                                                <HorizontalDivider height={1}/>\n                                                                <View style={styles(scales).li_elem}>\n                                                                    <View style={styles(scales).icon_container}>\n                                                                        <IcoMoonIcon name=\"stroller\"\n                                                                                     color={app_styles(scales).colors.app.blue}\n                                                                                     size={Math.round(scales.widthScale * 23)}/>\n                                                                    </View>\n                                                                    <View style={styles(scales).text_container}>\n                                                                        <Text\n                                                                            style={styles(scales).li_text}>{translator.translate(language, \"У мене мала дитина (до 12 років)\")}</Text>\n                                                                    </View>\n                                                                    <ButtonToggler\n                                                                        callback={() => handleFormInputs('have_a_child', !orderData.have_a_child)}\n                                                                        isActive={orderData.have_a_child}\n                                                                    />\n                                                                </View>\n\n                                                                <HorizontalDivider height={1}/>\n                                                                <View style={styles(scales).li_elem}>\n                                                                    <View style={styles(scales).icon_container}>\n                                                                        <IcoMoonIcon name=\"dog\"\n                                                                                     color={app_styles(scales).colors.app.blue}\n                                                                                     size={Math.round(scales.widthScale * 22)}/>\n                                                                    </View>\n                                                                    <View style={styles(scales).text_container}>\n                                                                        <Text\n                                                                            style={styles(scales).li_text}>{translator.translate(language, \"У мене є собака\")}</Text>\n                                                                    </View>\n                                                                    <ButtonToggler\n                                                                        callback={() => handleFormInputs('have_a_dog', !orderData.have_a_dog)}\n                                                                        isActive={orderData.have_a_dog}\n                                                                    />\n                                                                </View>\n\n                                                                <HorizontalDivider height={1}/>\n                                                            </View>\n                                                            <Spacer spaceHeight={30}/>\n\n                                                            {/* Payment Method */}\n                                                            <Text\n                                                                style={styles(scales).title}>{translator.translate(language, \"Спосіб оплати\")}</Text>\n                                                            <Spacer spaceHeight={20}/>\n                                                            <View>\n                                                                <ButtonRadio\n                                                                    value=\"cash\"\n                                                                    isSelected={orderData.payment_type === 'cash' || false}\n                                                                    label={translator.translate(language, \"Оплата готівкою\")}\n                                                                    callback={handlePaymentMethod}\n                                                                />\n                                                                <Spacer spaceHeight={12}/>\n                                                                <ButtonRadio\n                                                                    value=\"online\"\n                                                                    isSelected={orderData.payment_type === 'online' || false}\n                                                                    label={translator.translate(language, \"Оплата онлайн\")}\n                                                                    callback={handlePaymentMethod}\n                                                                />\n                                                            </View>\n                                                            <Spacer spaceHeight={30}/>\n\n                                                            {/* Total */}\n                                                            <HorizontalDivider height={1}/>\n                                                            <Spacer spaceHeight={15}/>\n                                                            <View style={app_styles(scales).row_between}>\n                                                                <Text\n                                                                    style={styles(scales).li_text}>{translator.translate(language, \"Товари\")}</Text>\n                                                                <Text\n                                                                    style={styles(scales).li_text}>{prices.products_price ? formatPrice(language, (prices.products_price + prices.extra_ingredients + prices.sauce_price)) + ' ' + translator.translate(language, \"грн\") : '-'}</Text>\n                                                            </View>\n                                                            {\n                                                                prices.packing_price > 0\n                                                                    ? (\n                                                                        <>\n                                                                            <Spacer spaceHeight={5}/>\n                                                                            <View style={app_styles(scales).row_between}>\n                                                                                <Text\n                                                                                    style={styles(scales).li_text}>{translator.translate(language, \"Пакування\")}</Text>\n                                                                                <Text\n                                                                                    style={styles(scales).li_text}>{prices.packing_price ? formatPrice(language, prices.packing_price) + ' ' + translator.translate(language, \"грн\") : '-'}</Text>\n                                                                            </View>\n                                                                        </>\n                                                                    )\n                                                                    : null\n                                                            }\n                                                            <Spacer spaceHeight={5}/>\n                                                            <View\n                                                                style={[app_styles(scales).row_between, {alignItems: 'flex-start'}]}>\n                                                                <Text\n                                                                    style={styles(scales).li_text}>{translator.translate(language, \"Доставка\")}</Text>\n                                                                <Text\n                                                                    style={styles(scales).li_text}>{prices.delivery_price ? formatPrice(language, prices.delivery_price) + ' ' + translator.translate(language, \"грн\") : translator.translate(language, 'безкоштовно')}</Text>\n\n                                                            </View>\n                                                            <Spacer spaceHeight={5}/>\n                                                            <View style={app_styles(scales).row_between}>\n                                                                <Text\n                                                                    style={styles(scales).total_title}>{translator.translate(language, \"Разом до оплати\")}</Text>\n                                                                <Text\n                                                                    style={styles(scales).total_price}>{formatPrice(language, prices.total_price)} {translator.translate(language, \"грн\")}</Text>\n                                                            </View>\n\n                                                            <Spacer spaceHeight={15}/>\n                                                            <HorizontalDivider height={1}/>\n                                                            <Spacer spaceHeight={30}/>\n                                                            <ButtonPrimary\n                                                                callback={formSubmit}\n                                                                title={translator.translate(language, \"Замовити\")}\n                                                                color={app_styles(scales).colors.app.blue}\n                                                                isDataLoading={isDataLoading}\n                                                            />\n                                                        </View>\n                                                        <Spacer spaceHeight={44}/>\n                                                    </Block>\n                                                </ScrollView>\n                                            ) : null\n                                    )\n                                    : <DataLoadingIndicator/>\n                            )\n                            : <NetworkErrorModal\n                                isOpened={networkError}\n                                closeCallback={networkError ? clearNetworkError : clearDeliveryCitiesNetworkError}\n                            />\n                    }\n                </View>\n            </SafeView>\n\n            {/* Success order modal */}\n            <SuccessOrderModal\n                isOpened={showSuccessOrderModal}\n                closeCallback={closeSuccessOrderModal}\n            />\n\n            {/* Before online payment modal */}\n            <OnlinePaymentInfoModal\n                isOpened={showOnlinePaymentInfoModal}\n                nextCallback={() => handleNextStep()}\n                cancelCallback={() => setShowOnlinePaymentInfoModal(false)}\n            />\n\n            {/* Clear cart modal */}\n            <ClearCartModal\n                isOpened={showClearCartModal}\n                clearCallback={() => clearCartCallback()}\n                cancelCallback={() => setShowClearCartModal(false)}\n            />\n\n            {/* Payment modal */}\n            <Modal\n                animationType=\"fade\"\n                transparent={false}\n                visible={showPaymentModal}\n            >\n                <View style={styles(scales).modal_content_container}>\n                    {/* Modal card */}\n                    <View style={styles(scales).modal_card}>\n                        {/* Body */}\n                        <WebView\n                            source={{uri: paymentWidgetHtml}}\n                            bounces={true}\n                            style={{flex: 1}}\n                            injectedJavaScript={injectedJavascript}\n                            startInLoadingState\n                            javaScriptEnabledAndroid={true}\n                            javaScriptEnabled={true}\n                            onMessage={event => {\n                                handleMessageFromWebView(event.nativeEvent.data);\n                            }}\n                            useWebKit={Platform.OS === 'ios' ? true : false}\n                        />\n                        <HorizontalDivider height={1}/>\n                        {/* Footer */}\n                        <TouchableOpacity onPress={handleClosePaymentModal}\n                                          style={styles(scales).close_modal_button_container}>\n                            <View style={styles(scales).modal_card_footer}>\n                                <Text\n                                    style={styles(scales).footer_title}>{translator.translate(language, \"закрити\")}</Text>\n                            </View>\n                        </TouchableOpacity>\n                    </View>\n                </View>\n            </Modal>\n        </KeyboardAvoidingView>\n    );\n}\n\n\n//----EXPORT----//\nexport default MakeOrderScreen;\n"]},"metadata":{},"sourceType":"module"}